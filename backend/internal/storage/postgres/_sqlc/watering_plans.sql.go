// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.28.0
// source: watering_plans.sql

package sqlc

import (
	"context"
	"time"

	"github.com/google/uuid"
)

const createWateringPlan = `-- name: CreateWateringPlan :one
INSERT INTO watering_plans (
  date, description, status, distance, total_water_required, cancellation_note, provider, additional_informations
) VALUES (
  $1, $2, $3, $4, $5, $6, $7, $8
) RETURNING id
`

type CreateWateringPlanParams struct {
	Date                   time.Time
	Description            string
	Status                 WateringPlanStatus
	Distance               *float64
	TotalWaterRequired     *float64
	CancellationNote       string
	Provider               *string
	AdditionalInformations []byte
}

func (q *Queries) CreateWateringPlan(ctx context.Context, arg *CreateWateringPlanParams) (int32, error) {
	row := q.db.QueryRow(ctx, createWateringPlan,
		arg.Date,
		arg.Description,
		arg.Status,
		arg.Distance,
		arg.TotalWaterRequired,
		arg.CancellationNote,
		arg.Provider,
		arg.AdditionalInformations,
	)
	var id int32
	err := row.Scan(&id)
	return id, err
}

const deleteAllTreeClusterFromWateringPlan = `-- name: DeleteAllTreeClusterFromWateringPlan :exec
DELETE FROM tree_cluster_watering_plans
WHERE watering_plan_id = $1
`

func (q *Queries) DeleteAllTreeClusterFromWateringPlan(ctx context.Context, wateringPlanID int32) error {
	_, err := q.db.Exec(ctx, deleteAllTreeClusterFromWateringPlan, wateringPlanID)
	return err
}

const deleteAllUsersFromWateringPlan = `-- name: DeleteAllUsersFromWateringPlan :exec
DELETE FROM user_watering_plans
WHERE watering_plan_id = $1
`

func (q *Queries) DeleteAllUsersFromWateringPlan(ctx context.Context, wateringPlanID int32) error {
	_, err := q.db.Exec(ctx, deleteAllUsersFromWateringPlan, wateringPlanID)
	return err
}

const deleteAllVehiclesFromWateringPlan = `-- name: DeleteAllVehiclesFromWateringPlan :exec
DELETE FROM vehicle_watering_plans
WHERE watering_plan_id = $1
`

func (q *Queries) DeleteAllVehiclesFromWateringPlan(ctx context.Context, wateringPlanID int32) error {
	_, err := q.db.Exec(ctx, deleteAllVehiclesFromWateringPlan, wateringPlanID)
	return err
}

const deleteWateringPlan = `-- name: DeleteWateringPlan :one
DELETE FROM watering_plans WHERE id = $1 RETURNING id
`

func (q *Queries) DeleteWateringPlan(ctx context.Context, id int32) (int32, error) {
	row := q.db.QueryRow(ctx, deleteWateringPlan, id)
	err := row.Scan(&id)
	return id, err
}

const getAllTreeClusterWateringPlanByID = `-- name: GetAllTreeClusterWateringPlanByID :many
SELECT tree_cluster_id, watering_plan_id, consumed_water
FROM tree_cluster_watering_plans
WHERE watering_plan_id = $1
`

func (q *Queries) GetAllTreeClusterWateringPlanByID(ctx context.Context, wateringPlanID int32) ([]*TreeClusterWateringPlan, error) {
	rows, err := q.db.Query(ctx, getAllTreeClusterWateringPlanByID, wateringPlanID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []*TreeClusterWateringPlan{}
	for rows.Next() {
		var i TreeClusterWateringPlan
		if err := rows.Scan(&i.TreeClusterID, &i.WateringPlanID, &i.ConsumedWater); err != nil {
			return nil, err
		}
		items = append(items, &i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getAllUserWateringPlanCount = `-- name: GetAllUserWateringPlanCount :one
SELECT COUNT(*) AS total_entries
FROM user_watering_plans
`

func (q *Queries) GetAllUserWateringPlanCount(ctx context.Context) (int64, error) {
	row := q.db.QueryRow(ctx, getAllUserWateringPlanCount)
	var total_entries int64
	err := row.Scan(&total_entries)
	return total_entries, err
}

const getAllWateringPlans = `-- name: GetAllWateringPlans :many
SELECT id, created_at, updated_at, date, description, status, distance, total_water_required, cancellation_note, gpx_url, refill_count, duration, provider, additional_informations FROM watering_plans
WHERE (COALESCE($3, '') = '' OR provider = $3)
ORDER BY date DESC
LIMIT $1 OFFSET $2
`

type GetAllWateringPlansParams struct {
	Limit    int32
	Offset   int32
	Provider interface{}
}

func (q *Queries) GetAllWateringPlans(ctx context.Context, arg *GetAllWateringPlansParams) ([]*WateringPlan, error) {
	rows, err := q.db.Query(ctx, getAllWateringPlans, arg.Limit, arg.Offset, arg.Provider)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []*WateringPlan{}
	for rows.Next() {
		var i WateringPlan
		if err := rows.Scan(
			&i.ID,
			&i.CreatedAt,
			&i.UpdatedAt,
			&i.Date,
			&i.Description,
			&i.Status,
			&i.Distance,
			&i.TotalWaterRequired,
			&i.CancellationNote,
			&i.GpxUrl,
			&i.RefillCount,
			&i.Duration,
			&i.Provider,
			&i.AdditionalInformations,
		); err != nil {
			return nil, err
		}
		items = append(items, &i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getAllWateringPlansCount = `-- name: GetAllWateringPlansCount :one
SELECT COUNT(*) FROM watering_plans
WHERE (COALESCE($1, '') = '' OR provider = $1)
`

func (q *Queries) GetAllWateringPlansCount(ctx context.Context, provider interface{}) (int64, error) {
	row := q.db.QueryRow(ctx, getAllWateringPlansCount, provider)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const getTotalConsumedWater = `-- name: GetTotalConsumedWater :one
SELECT SUM(consumed_water) AS total_consumed_water
FROM tree_cluster_watering_plans
`

func (q *Queries) GetTotalConsumedWater(ctx context.Context) (int64, error) {
	row := q.db.QueryRow(ctx, getTotalConsumedWater)
	var total_consumed_water int64
	err := row.Scan(&total_consumed_water)
	return total_consumed_water, err
}

const getTreeClustersByWateringPlanID = `-- name: GetTreeClustersByWateringPlanID :many
SELECT tc.id, tc.created_at, tc.updated_at, tc.watering_status, tc.last_watered, tc.moisture_level, tc.address, tc.description, tc.archived, tc.soil_condition, tc.latitude, tc.longitude, tc.geometry, tc.region_id, tc.name, tc.provider, tc.additional_informations
FROM tree_clusters tc
JOIN tree_cluster_watering_plans tcwp ON tc.id = tcwp.tree_cluster_id
WHERE tcwp.watering_plan_id = $1
`

func (q *Queries) GetTreeClustersByWateringPlanID(ctx context.Context, wateringPlanID int32) ([]*TreeCluster, error) {
	rows, err := q.db.Query(ctx, getTreeClustersByWateringPlanID, wateringPlanID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []*TreeCluster{}
	for rows.Next() {
		var i TreeCluster
		if err := rows.Scan(
			&i.ID,
			&i.CreatedAt,
			&i.UpdatedAt,
			&i.WateringStatus,
			&i.LastWatered,
			&i.MoistureLevel,
			&i.Address,
			&i.Description,
			&i.Archived,
			&i.SoilCondition,
			&i.Latitude,
			&i.Longitude,
			&i.Geometry,
			&i.RegionID,
			&i.Name,
			&i.Provider,
			&i.AdditionalInformations,
		); err != nil {
			return nil, err
		}
		items = append(items, &i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getUsersByWateringPlanID = `-- name: GetUsersByWateringPlanID :many
SELECT user_id
FROM user_watering_plans
WHERE watering_plan_id = $1
`

func (q *Queries) GetUsersByWateringPlanID(ctx context.Context, wateringPlanID int32) ([]uuid.UUID, error) {
	rows, err := q.db.Query(ctx, getUsersByWateringPlanID, wateringPlanID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []uuid.UUID{}
	for rows.Next() {
		var user_id uuid.UUID
		if err := rows.Scan(&user_id); err != nil {
			return nil, err
		}
		items = append(items, user_id)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getVehicleByWateringPlanID = `-- name: GetVehicleByWateringPlanID :one
SELECT v.id, v.created_at, v.updated_at, v.number_plate, v.description, v.water_capacity, v.type, v.status, v.model, v.driving_license, v.height, v.length, v.width, v.weight, v.provider, v.additional_informations, v.archived_at FROM vehicles v
JOIN vehicle_watering_plans vwp ON v.id = vwp.vehicle_id
WHERE vwp.watering_plan_id = $1
AND v.type = $2
`

type GetVehicleByWateringPlanIDParams struct {
	WateringPlanID int32
	Type           VehicleType
}

func (q *Queries) GetVehicleByWateringPlanID(ctx context.Context, arg *GetVehicleByWateringPlanIDParams) (*Vehicle, error) {
	row := q.db.QueryRow(ctx, getVehicleByWateringPlanID, arg.WateringPlanID, arg.Type)
	var i Vehicle
	err := row.Scan(
		&i.ID,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.NumberPlate,
		&i.Description,
		&i.WaterCapacity,
		&i.Type,
		&i.Status,
		&i.Model,
		&i.DrivingLicense,
		&i.Height,
		&i.Length,
		&i.Width,
		&i.Weight,
		&i.Provider,
		&i.AdditionalInformations,
		&i.ArchivedAt,
	)
	return &i, err
}

const getWateringPlanByID = `-- name: GetWateringPlanByID :one
SELECT id, created_at, updated_at, date, description, status, distance, total_water_required, cancellation_note, gpx_url, refill_count, duration, provider, additional_informations FROM watering_plans WHERE id = $1
`

func (q *Queries) GetWateringPlanByID(ctx context.Context, id int32) (*WateringPlan, error) {
	row := q.db.QueryRow(ctx, getWateringPlanByID, id)
	var i WateringPlan
	err := row.Scan(
		&i.ID,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.Date,
		&i.Description,
		&i.Status,
		&i.Distance,
		&i.TotalWaterRequired,
		&i.CancellationNote,
		&i.GpxUrl,
		&i.RefillCount,
		&i.Duration,
		&i.Provider,
		&i.AdditionalInformations,
	)
	return &i, err
}

const setTreeClusterToWateringPlan = `-- name: SetTreeClusterToWateringPlan :exec
INSERT INTO tree_cluster_watering_plans (tree_cluster_id, watering_plan_id)
VALUES ($1, $2)
`

type SetTreeClusterToWateringPlanParams struct {
	TreeClusterID  int32
	WateringPlanID int32
}

func (q *Queries) SetTreeClusterToWateringPlan(ctx context.Context, arg *SetTreeClusterToWateringPlanParams) error {
	_, err := q.db.Exec(ctx, setTreeClusterToWateringPlan, arg.TreeClusterID, arg.WateringPlanID)
	return err
}

const setUserToWateringPlan = `-- name: SetUserToWateringPlan :exec
INSERT INTO user_watering_plans (user_id, watering_plan_id)
VALUES ($1, $2)
`

type SetUserToWateringPlanParams struct {
	UserID         uuid.UUID
	WateringPlanID int32
}

func (q *Queries) SetUserToWateringPlan(ctx context.Context, arg *SetUserToWateringPlanParams) error {
	_, err := q.db.Exec(ctx, setUserToWateringPlan, arg.UserID, arg.WateringPlanID)
	return err
}

const setVehicleToWateringPlan = `-- name: SetVehicleToWateringPlan :exec
INSERT INTO vehicle_watering_plans (vehicle_id, watering_plan_id)
VALUES ($1, $2)
`

type SetVehicleToWateringPlanParams struct {
	VehicleID      int32
	WateringPlanID int32
}

func (q *Queries) SetVehicleToWateringPlan(ctx context.Context, arg *SetVehicleToWateringPlanParams) error {
	_, err := q.db.Exec(ctx, setVehicleToWateringPlan, arg.VehicleID, arg.WateringPlanID)
	return err
}

const updateTreeClusterWateringPlan = `-- name: UpdateTreeClusterWateringPlan :exec
UPDATE tree_cluster_watering_plans 
SET consumed_water = $3
WHERE watering_plan_id = $1
AND tree_cluster_id = $2
`

type UpdateTreeClusterWateringPlanParams struct {
	WateringPlanID int32
	TreeClusterID  int32
	ConsumedWater  float64
}

func (q *Queries) UpdateTreeClusterWateringPlan(ctx context.Context, arg *UpdateTreeClusterWateringPlanParams) error {
	_, err := q.db.Exec(ctx, updateTreeClusterWateringPlan, arg.WateringPlanID, arg.TreeClusterID, arg.ConsumedWater)
	return err
}

const updateWateringPlan = `-- name: UpdateWateringPlan :exec
UPDATE watering_plans SET
  date = $2,
  description = $3,
  status = $4,
  distance = $5,
  total_water_required = $6,
  cancellation_note = $7,
  gpx_url = $8,
  duration = $9,
  refill_count = $10,
  provider = $11,
  additional_informations = $12
WHERE id = $1
`

type UpdateWateringPlanParams struct {
	ID                     int32
	Date                   time.Time
	Description            string
	Status                 WateringPlanStatus
	Distance               *float64
	TotalWaterRequired     *float64
	CancellationNote       string
	GpxUrl                 *string
	Duration               float64
	RefillCount            int32
	Provider               *string
	AdditionalInformations []byte
}

func (q *Queries) UpdateWateringPlan(ctx context.Context, arg *UpdateWateringPlanParams) error {
	_, err := q.db.Exec(ctx, updateWateringPlan,
		arg.ID,
		arg.Date,
		arg.Description,
		arg.Status,
		arg.Distance,
		arg.TotalWaterRequired,
		arg.CancellationNote,
		arg.GpxUrl,
		arg.Duration,
		arg.RefillCount,
		arg.Provider,
		arg.AdditionalInformations,
	)
	return err
}
